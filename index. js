const express = require("express");
const bodyParser = require("body-parser");

const app = express();
app.use(bodyParser.urlencoded({ extended: false }));

app.post("/webhook", (req, res) => {
  const message = (req.body.Body || "").toLowerCase();

  let reponse = "Bonjour ğŸ‘‹ Je suis un bot WhatsApp automatique. Ã‰cris *menu*.";

  if (message.includes("bonjour") || message.includes("salut")) {
    reponse = "Bonjour ğŸ˜Š Bienvenue ! Ã‰cris *menu* pour voir les options.";
  } 
  else if (message.includes("menu")) {
    reponse =
      "ğŸ“‹ *MENU*\n" +
      "1ï¸âƒ£ Informations\n" +
      "2ï¸âƒ£ Prix\n" +
      "3ï¸âƒ£ Contact\n\n" +
      "RÃ©ponds avec un numÃ©ro.";
  } 
  else if (message === "1") {
    reponse = "â„¹ï¸ Nous offrons des services professionnels.";
  } 
  else if (message === "2") {
    reponse = "ğŸ’° Nos prix commencent Ã  partir de 50â‚¬.";
  } 
  else if (message === "3") {
    reponse = "ğŸ“ Contact : +123 456 789.";
  } 
  else {
    reponse = "â“ Je nâ€™ai pas compris. Ã‰cris *menu*.";
  }

  res.set("Content-Type", "text/xml");
  res.send(`
    <Response>
      <Message>${reponse}</Message>
    </Response>
  `);
});

app.listen(process.env.PORT || 3000);
